<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>libC Symbol</title>

    <link rel="icon" href="static/img/favicon.png">
    <link href="static/css/bootstrap.min.css" rel="stylesheet">
    <link href="static/css/sticky-footer.css" rel="stylesheet">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
     <div class="container">
      <div class="page-header">
        <h1>I don't know</h1>
      </div>

      <div class="panel panel-info">
        <div class="panel-heading"><h3 class="panel-title">Query result</h3></div>
        <div class="panel-body">
        <small>
          <p>{{ web.msg }}</p>
          {% for faith in web.hope %}
          <div class="panel panel-success">
            <div class="panel-heading"><b>{{ faith.name }}</b></div>
            <div class="panel-body">
              <p class="input-group input-group-sm">
                <span class="input-group-addon" style="color:red"><b>arch machine</b></span>
                <input type="text" class="form-control" value="{{ faith.arch }}" readonly>
              </p>
              <p class="input-group input-group-sm">
                <span class="input-group-addon"><b>md5</b></span>
                <input type="text" class="form-control" value="{{ faith.hash.md5 }}" readonly>
              </p>
              <p class="input-group input-group-sm">
                <span class="input-group-addon"><b>sha1</b></span>
                <input type="text" class="form-control" value="{{ faith.hash.sha1 }}" readonly>
              </p>
              <p class="input-group input-group-sm">
                <span class="input-group-addon"><b>sha256</b></span>
                <input type="text" class="form-control" value="{{ faith.hash.sha256 }}" readonly>
              </p>
              <p class="input-group input-group-sm">
                <span class="input-group-addon"><b>description</b></span>
                <input type="text" class="form-control" value="{{ faith.desc }}" readonly>
              </p>
              {% for sym in faith.symbol %}
              <p class="input-group input-group-sm">
                <span class="input-group-addon" style="color:green"><b>{{ sym[0] }}</b></span>
                {% if sym[1]!=-1 %}
                  <input type="text" class="form-control" value="{{ sym[2] }} = {{ sym[1] }}" readonly>
                {% else %}
                  <input type="text" class="form-control" value="not found" readonly>
                {% endif %}
                
              </p>
              
              {% endfor %}
            </div>
          </div>
          {% endfor %}
        </small>
        </div>

      </div>
      
      <div class="panel panel-info">
        <div class="panel-heading"><h3 class="panel-title">How to get</h3></div>
        <div class="panel-body">
          <p><span class="label label-info">libc</span> <small><a href="http://libc.trich.im/?strlen=0x889b0">http://libc.trich.im/?<span style="color:red">strlen=0x889b0</span></a></small></p>
          <p><span class="label label-info">libc</span> <small><a href="http://libc.trich.im/?strlen=0x889b0&puts=0x6fd60">http://libc.trich.im/?<span style="color:grey">strlen=0x889b0</span>&<span style="color:red">puts=0x6fd60</span></a></small></p>
          <p><span class="label label-info">symbol</span> <small><a href="http://libc.trich.im/?puts=0x6fd60&system=?">http://libc.trich.im/?<span style="color:red">system=?</span>&<span style="color:grey">puts=0x6fd60</span></a></small></p>
          <p><span class="label label-info">symbol</span> <small><a href="http://libc.trich.im/?system=?&puts=0x6fd60&strlen=?">http://libc.trich.im/?<span style="color:grey">system=?</span>&<span style="color:grey">puts=0x6fd60</span>&<span style="color:red">strlen=?</span></a></small></p>
          <p><span class="label label-info">binsh</span> <small><a href="http://libc.trich.im/?strlen=0x889b0&puts=0x6fd60&binsh=?">http://libc.trich.im/?<span style="color:grey">strlen=0x889b0</span>&<span style="color:grey">puts=0x6fd60</span>&<span style="color:red">binsh=?</span></a></small></p>
          <p><span class="label label-info">gotplt</span> <small><a href="http://libc.trich.im/?strlen=0x889b0&puts=0x6fd60&gotplt=?">http://libc.trich.im/?<span style="color:grey">strlen=0x889b0</span>&<span style="color:grey">puts=0x6fd60</span>&<span style="color:red">gotplt=?</span></a></small></p>
          <p><span class="label label-info">magic1</span> <small><a href="http://libc.trich.im/?strlen=0x889b0&puts=0x6fd60&magic1=?">http://libc.trich.im/?<span style="color:grey">strlen=0x889b0</span>&<span style="color:grey">puts=0x6fd60</span>&<span style="color:red">magic1=?</span></a></small></p>
          <p><span class="label label-info">magic2</span> <small><a href="http://libc.trich.im/?strlen=0x889b0&puts=0x6fd60&magic2=?">http://libc.trich.im/?<span style="color:grey">strlen=0x889b0</span>&<span style="color:grey">puts=0x6fd60</span>&<span style="color:red">magic2=?</span></a></small></p>
          <p><span class="label label-info">magic3</span> <small><a href="http://libc.trich.im/?strlen=0x889b0&puts=0x6fd60&magic3=?">http://libc.trich.im/?<span style="color:grey">strlen=0x889b0</span>&<span style="color:grey">puts=0x6fd60</span>&<span style="color:red">magic3=?</span></a></small></p>
          <p><span class="label label-info">json</span> <small><a href="http://libc.trich.im/json?strlen=0x889b0&puts=0x6fd60&system=?">http://libc.trich.im/<span style="color:red">json</span>?<span style="color:grey">strlen=0x889b0</span>&<span style="color:grey">puts=0x6fd60</span>&<span style="color:grey">system=?</span></a></small></p>
        </div>
      </div>

      <div class="panel panel-info">
        <div class="panel-heading"><h3 class="panel-title">What is <button type="button" class="btn btn-default">binsh</button> <button type="button" class="btn btn-default">gotplt</button> <button type="button" class="btn btn-default">magic</button> </h3></div>
        <div class="panel-body">
        <small>
          <div class="whatis" id="inst">Click to show</div>
          <div class="whatis" id="binsh"><img src="static/img/binsh.png"></div>
          <div class="whatis" id="gotplt">
            <p>This gadget is needed when using ROP in libc-i386 (x86)</p>
            <p><img src="static/img/gotplt1.png"></p>
            <p>EBX (sometime ESI) = gotplt</p>
            <p><img src="static/img/gotplt2.png"></p>
          </div>
          <div class="whatis" id="magic">
            <p>These magic gadgets use to be called/returned once to pop shell. They need some conditions</p>
            <div class="panel panel-default">
              <div class="panel-heading">intel386 (x86)</div>
              <div class="panel-body">
                <p>EBX (or ESI) must be set as gotplt value (see tab)</p>
                <p>First gadget</p>
                <p><img src="static/img/magic1_32.png"></p>
                <p>Second/Third gadget</p>
                <p><img src="static/img/magic23_32.png"></p>
              </div>
            </div>

            <div class="panel panel-default">
              <div class="panel-heading">amd64 (x64)</div>
              <div class="panel-body">
                <p>All three have same params but difference stack condition</p>
                <p><img src="static/img/magic_64.png"></p>
                <p>First gadget: [rsp+0x30] must be NULL</p>
                <p>Second gadget: [rsp+0x50] must be NULL</p>
                <p>Third gadget: [rsp+0x70] must be NULL</p>
              </div>
            </div>

          </div>
        </small>
        </div>
      </div>

      <div class="panel panel-info">
        <div class="panel-heading"><h3 class="panel-title">Current collection</h3></div>
        <div class="panel-body">
        <small>
        {{ web.countlib }} little guys
        </div>
        </small>
      </div>
    </div>

    <footer class="footer">
      <div class="container">
        <p class="text-muted">Ver1.0 <a href="https://github.com/trichimtrich/libcsymbolcollection">GitHub</a> <a href="https://twitter.com/trichimtrich">Twitter</a></p>
      </div>
    </footer>

    <script src="static/js/jquery.min.js"></script>
    <script src="static/js/bootstrap.min.js"></script>

    <script>
      $(document).ready(function(){
          $("#binsh").hide();
          $("#magic").hide();
          $("#gotplt").hide();
          $("button").click(function () {
            $(".whatis").hide();
            $("#" + $(this).html()).show(500);
          });
      });
    </script>

  </body>
</html>